<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Will you be my Valentine, DVK? üíò</title>
  <meta name="description" content="Mobile-only chaotic Valentine with 30s chaos countdown, decoys, golden YES finale with confetti drop-bounce, and extra snark." />
  <meta name="theme-color" content="#ff2e63" />
  <style>
    :root{
      --bg1:#ffdee9; --bg2:#b5fffc; --pink:#ff4d8d; --rose:#ff6fa3; --red:#ff2e63;
      --dark:#2c2c35; --white:#fff; --shadow:0 20px 40px rgba(0,0,0,.12); --shadow-soft:0 10px 25px rgba(0,0,0,.10);
      --gold1:#ffdd66; --gold2:#ffb347; --gold3:#ffd700;
    }
    *{ box-sizing:border-box; }
    html,body{
      height:100%; margin:0;
      font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
      color: var(--dark);
      background:
        radial-gradient(1200px 600px at 20% 0%,#fff0f6,transparent 70%),
        radial-gradient(800px 500px at 90% 20%,#e6fffb,transparent 60%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      min-width: 320px;
    }
    main.card{
      max-width: 840px; margin: 5vh auto; background: var(--white); border-radius: 20px;
      box-shadow: var(--shadow); padding: clamp(18px, 3.5vw, 36px); position: relative; overflow: hidden; isolation: isolate;
    }
    h1{ font-size: clamp(28px, 4.6vw, 48px); line-height: 1.15; margin: 0 0 6px; }
    .sub{ margin: 0 0 24px; opacity: .85; font-size: clamp(14px,2.5vw,18px); }
    .accent{ color: var(--red); font-weight: 800; }
    .hint{ font-size: 13px; opacity: .75; margin: 0 0 8px; }
    .buttons{
      display: grid; grid-template-columns: 1fr 1fr; gap: 14px;
      align-items: center; justify-content: center; position: relative;
      min-height: 210px; padding: 10px; overflow: visible;
    }
    .btn{
      cursor: pointer; font-size: clamp(18px,3.5vw,22px);
      padding: 16px 24px; border-radius: 14px; border: none;
      box-shadow: var(--shadow-soft);
      background: #fff; user-select: none; position: relative; z-index: 2;
      transition: transform .15s ease, box-shadow .15s ease, top .18s ease, left .18s ease;
    }
    .btn:hover{ transform: translateY(-2px); box-shadow: 0 14px 24px rgba(0,0,0,.12); }
    .btn:disabled{ opacity:.6; cursor:not-allowed; transform:none !important; box-shadow: var(--shadow-soft); }
    .btn.yes{ background: linear-gradient(135deg, #fff, #ffe8f1); border: 2px solid #ffd0e0; color: var(--red); font-weight: 800; }
    .btn.no{ background: #fff; border: 2px dashed #ffb9d1; color: #6f6f7a; font-weight: 700; }
    .btn.primary{ background: var(--red); color: #fff; }

    /* Chaos countdown chip */
    .chip{
      position: absolute;
      right: 12px; top: 12px;
      background: #fff3fa;
      color: #a7004e;
      border: 1px solid #ffc2dc;
      border-radius: 999px;
      padding: 8px 12px;
      font-size: 13px;
      box-shadow: var(--shadow-soft);
      display: inline-flex; align-items: center; gap: 8px;
      z-index: 5;
    }
    .chip .dot{ width:8px; height:8px; border-radius:50%; background:#ff5aa5; box-shadow: 0 0 0 0 rgba(255,90,165,.8); animation: ping 1.4s infinite; }
    @keyframes ping{ 100%{ box-shadow: 0 0 0 10px rgba(255,90,165,0); } }

    .taunt{ min-height: 36px; margin: 16px 2px 8px; font-size: clamp(14px,2.4vw,18px); color: #7a7a86; }
    .tiny{ margin-top: 18px; font-size: 12px; opacity: .65; }

    .overlay{
      position: fixed; inset: 0; display: grid; place-items: center;
      background: rgba(255,240,246,.88); z-index: 50; backdrop-filter: blur(3px);
    }
    .overlay[hidden]{ display:none; }
    .overlay-card{ background:#fff; border-radius:18px; padding:24px; max-width:620px; text-align:center; box-shadow: var(--shadow); }

    #hearts, #sparkles{ position: fixed; inset: 0; overflow: hidden; pointer-events: none; z-index: 40; }

    /* Chaos floating mode */
    .buttons .btn.floating, .decoy{ position: absolute !important; will-change: transform, top, left; z-index: 3; }

    /* Golden YES finale */
    .golden-yes{
      background: linear-gradient(135deg, var(--gold1), var(--gold2));
      border: 2px solid #f7c948;
      color: #6b3a00;
      font-weight: 900;
      text-shadow: 0 1px 0 rgba(255,255,255,.5);
      box-shadow: 0 12px 24px rgba(248, 191, 60, .35), inset 0 0 0 2px rgba(255,255,255,.4);
      animation: glow 1.2s ease-in-out infinite alternate;
    }
    .golden-yes.floaty-on{
      animation: glow 1.2s ease-in-out infinite alternate, floaty 2.2s ease-in-out infinite;
    }
    .golden-yes.drop-bounce{
      animation: dropBounce 700ms cubic-bezier(.22,.61,.36,1) both, glow 1.2s ease-in-out infinite alternate;
    }
    @keyframes glow{
      from{ filter: drop-shadow(0 0 0 rgba(255,215,0,0.0)); }
      to  { filter: drop-shadow(0 0 12px rgba(255,215,0,0.75)); }
    }
    @keyframes floaty{
      0%{ transform: translateY(0); } 50%{ transform: translateY(-4px);} 100%{ transform: translateY(0); }
    }
    @keyframes dropBounce{
      0%   { transform: translateY(-160%) scale(0.96); opacity: 0; }
      60%  { transform: translateY(0%) scale(1.04); opacity: 1; }
      80%  { transform: translateY(-12%) scale(0.99); }
      100% { transform: translateY(0%) scale(1); }
    }

    /* Heart particles */
    .heart{
      position: absolute; width: 14px; height: 14px; transform: rotate(45deg); background: var(--pink);
      box-shadow: 0 6px 16px rgba(255,0,85,.25); animation: floatUp linear forwards;
    }
    .heart::before, .heart::after{ content:""; position:absolute; width:14px; height:14px; border-radius:50%; background:inherit; top:-7px; left:0; }
    .heart::after{ left:-7px; top:0; }
    @keyframes floatUp{ 0%{opacity:0; transform: translateY(0) rotate(45deg) scale(.6);}10%{opacity:1;}100%{opacity:0; transform: translateY(-110vh) rotate(45deg) scale(1.2);} }

    /* Sparkles / confetti */
    .sparkle{ position:absolute; font-size:16px; animation: popUp .9s ease-out forwards; filter: drop-shadow(0 6px 12px rgba(255,0,128,.25)); }
    @keyframes popUp{ 0%{ transform: translateY(0) scale(.6) rotate(0deg); opacity:0; } 35%{opacity:1;} 100%{ transform: translateY(-80px) scale(1.2) rotate(10deg); opacity:0;} }

    .confetti{
      position: absolute;
      width: 8px; height: 14px;
      opacity: 0.95;
      transform: translate(0,0) rotate(0deg);
      animation: confettiFall linear forwards;
      border-radius: 2px;
    }
    @keyframes confettiFall{
      0%   { transform: translate(0, -20px) rotate(0deg); opacity: 0; }
      10%  { opacity: 1; }
      100% { transform: translate(var(--dx), var(--dy)) rotate(var(--rot)); opacity: 0; }
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .btn,.heart,.sparkle,.confetti{ transition:none !important; animation:none !important; }
    }
    /* Mobile layout nudge */
    @media (max-width: 560px){
      .buttons{ grid-template-columns: 1fr; gap: 12px; min-height: 290px; }
      .buttons .btn.floating, .decoy{ position: absolute; }
    }
  </style>
</head>
<body>
  <main class="card" id="stage">
    <header>
      <h1>Will you be my Valentine, <span class="accent">DVK</span>? üíù</h1>
      <p class="sub">Tip: Open this on your phone for the full chaos. üòè</p>
      <p id="desktopHint" class="hint" hidden>Hint: You‚Äôre on desktop‚Äîgolden YES will appear to confirm.</p>
    </header>

    <!-- Chaos countdown chip (shown during chaos on mobile) -->
    <div id="decoyChip" class="chip" hidden>
      <span class="dot" aria-hidden="true"></span>
      <span>Chaos countdown: <strong id="chipTime">0:30</strong></span>
    </div>

    <section class="buttons" id="buttonsArea">
      <button id="yesBtn" class="btn yes" aria-label="Yes">YES üíû</button>
      <button id="noBtn" class="btn no" aria-label="No">NO üôÉ</button>
    </section>

    <p id="taunt" class="taunt" aria-live="polite" role="status"></p>

    <footer class="tiny">
      Made with üíó by <span class="accent">KGT</span>
    </footer>
  </main>

  <!-- Success overlay (romantic) -->
  <div id="successOverlay" class="overlay" hidden>
    <div class="overlay-card">
      <h2>She said <span class="accent">YES</span>! üéâ</h2>
      <p style="margin: 12px 0 0; font-size: 18px; line-height: 1.55;">
        <strong>DVK</strong>,<br>
        Every ordinary day with you feels like something the universe wrote on purpose.<br>
        Thank you for being the soft and steady in my world‚Äîthe warm every morning, the calm in the noise.<br>
        Today and always, I choose you‚Äîyour smile, your laugh, your heart‚Äîand the peace I find in all of them.<br>
        <em>Happy Valentine‚Äôs Day. Forever yours ‚Äî KGT ‚ù§Ô∏è</em>
      </p>
      <button class="btn primary" id="replayBtn" style="margin-top:16px;">Replay hearts</button>
    </div>
  </div>

  <!-- Party layers -->
  <div id="hearts"></div>
  <div id="sparkles"></div>

  <script>
    /* ==============================
       Mobile-only Chaos + 30s Chaos Countdown + Golden YES (drop-bounce + confetti, ONLY confirm)
       + Extra Snark (including on decoy taps)
    ================================*/

    // ---- Capability / mobile gating ----
    const MOBILE_WIDTH_MAX = 600;
    const IS_MOBILE = (window.matchMedia && matchMedia(`(max-width:${MOBILE_WIDTH_MAX}px)`).matches)
                      || ('ontouchstart' in window)
                      || (navigator.maxTouchPoints > 0);

    // Show hint if not mobile
    const desktopHint = document.getElementById('desktopHint');
    if (!IS_MOBILE) desktopHint.hidden = false;

    // ---- Config ----
    const YES_FAST_MS         = 6000;     // YES before this -> fake on mobile
    const MISCHIEF_MIN_MS     = 9000;     // For messaging only
    const REQUIRED_TAUNTS     = 6;        // For messaging only

    const DECOY_INTERVAL_MS   = 1000;     // continuous decoy spawns during chaos (mobile)
    const DECOY_DURATION_MS   = 30000;    // ‚è±Ô∏è total time decoys are allowed (30s)
    const MAX_DECOYS          = 18;       // cap for performance
    const JITTER_MS           = 360;      // jiggle speed during chaos (mobile)

    // NO growth parameters (exponential over time)
    const NO_GROWTH_BASE = 1.035;
    const NO_MAX_SCALE   = 4.2;
    const NO_TICK_MS     = 160;

    // Elements
    const yesBtn   = document.getElementById('yesBtn');
    const noBtn    = document.getElementById('noBtn');
    const tauntEl  = document.getElementById('taunt');
    const buttons  = document.getElementById('buttonsArea');
    const overlay  = document.getElementById('successOverlay');
    const hearts   = document.getElementById('hearts');
    const sparkles = document.getElementById('sparkles');
    const replayBtn= document.getElementById('replayBtn');
    const chip     = document.getElementById('decoyChip');
    const chipTime = document.getElementById('chipTime');

    // State
    const startTime = performance.now();
    let mischief = false, allowRealYes = false;
    let tauntIndex = 0, tauntsShown = 0;
    let noScale = 1.0;
    let decoys = [];
    let jitterTimer = null, decoyIntervalId = null, decoyEndTimeoutId = null, chipTimerId = null;
    let mischiefStart = null;
    let goldenYesBtn = null;

    // Extra snarky one-liners (general chaos)
    const TAUNTS = [
      "Speedrun detected. Any% is banned in this category. üèÅ",
      "You can‚Äôt cookie-popup YES your way into love. üç™",
      "The YES is shy. Compliment it first. üòâ",
      "Close! That was the demo. Insert coin. ü™ô",
      "Captcha: Select all squares with TRUE LOVE. ‚ù§Ô∏è",
      "Patience increases charm by +10. ‚ú®",
      "Almost there‚Ä¶ grin a little more. üòÅ",
      "Nice try. That button has commitment issues. üòÇ",
      "Error 404: Instant YES not found. Try vibes. üîç",
      "Buffering romance‚Ä¶ please stand adorably by. ‚è≥",
      "Terms of Service require at least one smile. ‚úÖ",
      "We detected excessive cuteness. Please proceed. ü•∞",
      "Patch notes: YES now requires 1 (one) blush. üåπ",
      "Warning: Tapping faster won‚Äôt unlock Ultra YES. ‚ö†Ô∏è",
      "Fun fact: Your laugh increases accuracy by 200%. üéØ",
      "Suspicious activity: Too confident. Adorable tho. üòå",
      "Tip: Whisper 'pretty please' to your screen. It helps. ü§´",
      "Today‚Äôs forecast: 100% chance of you saying YES. ‚òÄÔ∏è",
      "Plot twist: The decoys were your friends all along. ü´∂",
      "Loading sincerity‚Ä¶ okay wow that‚Äôs a lot. üíó",
      "New achievement: ‚ÄòButton Chaser‚Äô. +50 charm. üèÖ",
      "Hint: Smiling unlocks hidden dialogue options. üòâ",
      "Your taps are cute, but your yes will be cuter. üíû",
      "All roads lead to YES. Some just go scenic. üå∏",
    ];

    // üî• Snark specifically for DECOY taps
    const DECOY_SNARKS = [
      "Decoy tapped: +1 to your mischievous stats. üòà",
      "Fake YES speedrun PB achieved. New goal: golden YES. üèÖ",
      "You caught a shiny‚Ä¶ decoy. Try again. ‚ú®",
      "Oops‚Äîall decoys! Limited edition chaos. üå™Ô∏è",
      "That YES was 100% certified impostor. ü•∏",
      "Plot twist: That button is emotionally unavailable. üôÉ",
      "Decoy says: ‚ÄòIt‚Äôs not you, it‚Äôs me.‚Äô (it‚Äôs you). üòâ",
      "Nice click. Wrong universe. Multiverse says hi. üåå",
      "Close enough to be adorable, not enough to be golden. üíõ",
      "CIA has flagged you as a button chaser. üïµÔ∏è",
      "That was a tutorial YES. The final boss is golden. üëë",
      "Decoy: 1 | You: still cute. Try again. üíò",
      "Eligibility check failed: Must be grinning more. üòÅ",
      "Decoy giggles and runs away. Coward. üê≠",
      "You‚Äôve unlocked: Bamboozled (Common). üß©",
    ];

    // Utils
    const rand = (min, max) => Math.random() * (max - min) + min;
    const clamp = (v, a, b) => Math.max(a, Math.min(b, v));
    const timeElapsedMs = () => performance.now() - startTime;
    const pad2 = n => n < 10 ? "0" + n : "" + n;

    function sparkleBurst(x, y){
      const emojis = ["‚ú®","üíñ","üí´","üíû","üåü","üíò"];
      const count = 10;
      for (let i=0;i<count;i++){
        const s = document.createElement('div');
        s.className = 'sparkle';
        s.textContent = emojis[Math.floor(Math.random()*emojis.length)];
        s.style.left = (x + rand(-18, 18)) + 'px';
        s.style.top  = (y + rand(-12, 12)) + 'px';
        s.style.fontSize = (14 + Math.random()*12) + 'px';
        sparkles.appendChild(s);
        setTimeout(()=> s.remove(), 1000);
      }
    }

    /* ---------- Fun confetti burst ---------- */
    function confettiBurst(x, y, count = 80){
      const colors = ['#ff2e63','#f7b500','#00d1b2','#8257e6','#ff6fa3','#ffd166','#06d6a0','#118ab2'];
      for (let i=0;i<count;i++){
        const c = document.createElement('div');
        c.className = 'confetti';
        const color = colors[Math.floor(Math.random()*colors.length)];
        const dx = (Math.random()*2-1) * (80 + Math.random()*120);
        const dy = (120 + Math.random()*200);
        const rot = (Math.random()*720 - 360) + 'deg';
        const dur = 1200 + Math.random()*900; // ms
        c.style.left = (x + (Math.random()*40 - 20)) + 'px';
        c.style.top  = (y + (Math.random()*20 - 10)) + 'px';
        c.style.background = color;
        c.style.setProperty('--dx', dx + 'px');
        c.style.setProperty('--dy', dy + 'px');
        c.style.setProperty('--rot', rot);
        c.style.animationDuration = dur + 'ms';
        const w = 6 + Math.random()*5, h = 10 + Math.random()*8;
        c.style.width = w + 'px'; c.style.height = h + 'px';
        sparkles.appendChild(c);
        setTimeout(()=> c.remove(), dur + 100);
      }
    }

    /* ---------- NO: exponential growth ---------- */
    function updateNoGrowth(){
      const seconds = timeElapsedMs() / 1000;
      noScale = Math.min(NO_MAX_SCALE, Math.pow(NO_GROWTH_BASE, seconds));
      noBtn.style.transform = `scale(${noScale}) rotate(${(noScale-1)*4}deg)`;
    }
    const growthInterval = setInterval(updateNoGrowth, NO_TICK_MS);
    updateNoGrowth();

    /* ---------- Countdown chip ---------- */
    function startCountdownChip(){
      if (!IS_MOBILE) return;
      chip.hidden = false;
      updateChipTime();
      if (chipTimerId) clearInterval(chipTimerId);
      chipTimerId = setInterval(updateChipTime, 1000);
    }
    function stopCountdownChip(){
      chip.hidden = true;
      if (chipTimerId) clearInterval(chipTimerId);
      chipTimerId = null;
    }
    function updateChipTime(){
      if (!mischiefStart) return;
      const msLeft = Math.max(0, DECOY_DURATION_MS - (performance.now() - mischiefStart));
      const s = Math.ceil(msLeft/1000);
      const m = Math.floor(s / 60);
      const ss = pad2(s % 60);
      chipTime.textContent = `${m}:${ss}`;
      if (s === 0){
        chipTime.textContent = "0:00";
      }
    }

    /* ---------- Chaos helpers (mobile only) ---------- */
    function showTaunt(custom){
      const msg = custom || TAUNTS[tauntIndex++ % TAUNTS.length];
      tauntsShown++;
      tauntEl.textContent = msg;

      if (IS_MOBILE && mischief && decoyWindowActive()) spawnDecoyNear(yesBtn, randomYesLabel());
    }

    function scramble(el){
      const area = buttons.getBoundingClientRect();
      const b = el.getBoundingClientRect();
      const maxLeft = Math.max(0, area.width - b.width);
      const maxTop  = Math.max(0, area.height - b.height);
      el.style.left = (Math.random()*maxLeft) + 'px';
      el.style.top  = (Math.random()*maxTop) + 'px';
      el.style.transition = 'top .18s ease, left .18s ease, transform .12s ease';

      if (IS_MOBILE && mischief && decoyWindowActive()) spawnDecoyNear(el, randomYesLabel());
    }

    function jitter(){
      if (!mischief) return;
      [...decoys, yesBtn, noBtn].forEach(el=>{
        if (!el.classList.contains('floating') && !el.classList.contains('decoy')) return;
        const dx = rand(-6,6), dy = rand(-4,8), rot = rand(-2,2);
        el.style.transform = `translate(${dx}px, ${dy}px) rotate(${rot}deg)`;
      });
    }
    function startJitter(){ if (!IS_MOBILE) return; if (!jitterTimer) jitterTimer = setInterval(jitter, JITTER_MS); }
    function stopJitter(){ if (jitterTimer){ clearInterval(jitterTimer); jitterTimer = null; } }

    /* ---------- Decoy lifecycle control (30s window) ---------- */
    function decoyWindowActive(){
      if (!mischiefStart) return false;
      return (performance.now() - mischiefStart) < DECOY_DURATION_MS;
    }
    function timeLeftInDecoyWindow(){
      if (!mischiefStart) return 0;
      return Math.max(0, DECOY_DURATION_MS - (performance.now() - mischiefStart));
    }

    function startDecoyInterval(){
      if (!IS_MOBILE) return;
      if (decoyIntervalId) return;
      decoyIntervalId = setInterval(()=>{
        if (!mischief || !decoyWindowActive()) return;
        if (decoys.length < MAX_DECOYS) spawnDecoyNear(yesBtn, randomYesLabel());
      }, DECOY_INTERVAL_MS);
    }
    function stopDecoyInterval(){ if (decoyIntervalId){ clearInterval(decoyIntervalId); decoyIntervalId = null; } }

    function scheduleDecoyWindowEnd(){
      if (decoyEndTimeoutId) clearTimeout(decoyEndTimeoutId);
      decoyEndTimeoutId = setTimeout(()=>{
        stopDecoyInterval();
        decoys.forEach(d=> d.remove());
        decoys = [];
        showTaunt("Okay, chaos cooldown engaged. The decoys have clocked out. üïí");
        stopCountdownChip();
        spawnGoldenYes(true); // confetti + bounce
      }, DECOY_DURATION_MS);
    }

    function randomYesLabel(){
      const labels = ["YES üíó","YES?! üíñ","YEP üíì","SURE üíû","ABSOLUTELY üíò","YES* üíù","PROBABLY üíü","HECK YES üíú"];
      return labels[Math.floor(Math.random()*labels.length)];
    }

    function startMischief(){
      if (!IS_MOBILE) return; // mobile-only chaos
      if (mischief) return;
      mischief = true;
      tauntsShown = 0;
      mischiefStart = performance.now();

      yesBtn.classList.add('floating'); noBtn.classList.add('floating');
      scramble(yesBtn); scramble(noBtn);

      ['touchstart','pointerdown','mouseenter'].forEach(evt=>{
        yesBtn.addEventListener(evt, (e)=>{ scramble(yesBtn); const t=e.touches?.[0]; sparkleBurst((t?.clientX??e.clientX)||0, (t?.clientY??e.clientY)||0); showTaunt(); }, {passive:true});
        noBtn.addEventListener(evt, ()=>{ scramble(noBtn); }, {passive:true});
      });

      spawnDecoyNear(yesBtn, "YES üíñ (trust me)");
      startJitter();
      startDecoyInterval();
      scheduleDecoyWindowEnd();
      startCountdownChip();

      const remainingFast = Math.max(0, YES_FAST_MS - timeElapsedMs());
      const minChaos = Math.max(MISCHIEF_MIN_MS, remainingFast);
      setTimeout(maybeUnlockRealYes, minChaos);
    }

    function maybeUnlockRealYes(){
      if (!IS_MOBILE){ allowRealYes = true; return; }
      if (tauntsShown >= REQUIRED_TAUNTS){
        allowRealYes = true;
        tauntEl.textContent = "Cupid has verified your vibes. Watch for the golden YES. üíò";
      } else {
        const chk = setInterval(()=>{
          if (tauntsShown >= REQUIRED_TAUNTS){
            clearInterval(chk);
            allowRealYes = true;
            tauntEl.textContent = "Okay‚Äîyou earned it. The golden YES will appear. üíû";
          }
        }, 700);
      }
    }

    /* ---------- Decoys ---------- */
    function spawnDecoyNear(anchorEl, label="YES üíñ"){
      if (!IS_MOBILE) return;
      if (!decoyWindowActive()) return;
      if (decoys.length >= MAX_DECOYS) return;

      const d = document.createElement('button');
      d.className = 'btn yes decoy';
      d.textContent = label;
      d.setAttribute('aria-label','Definitely a real YES (not a trap)');
      buttons.appendChild(d);
      positionDecoy(anchorEl, d);
      hookDecoy(d);
      decoys.push(d);

      const ttl = timeLeftInDecoyWindow();
      setTimeout(()=> { if (d.isConnected) d.remove(); decoys = decoys.filter(x=>x!==d); }, ttl);
      return d;
    }

    function positionDecoy(anchorEl, d){
      const a = anchorEl.getBoundingClientRect();
      const area = buttons.getBoundingClientRect();
      const left = clamp(a.left - area.left + (Math.random()*180-90), 0, area.width - Math.max(100, a.width*0.9));
      const top  = clamp(a.top  - area.top  + (Math.random()*140-60), 0, area.height - Math.max(60, a.height*0.9));
      d.style.left = left + 'px';
      d.style.top  = top  + 'px';
    }

    function hookDecoy(d){
      ['touchstart','pointerdown','mouseenter'].forEach(evt=>{
        d.addEventListener(evt, (e)=>{
          e.preventDefault(); e.stopPropagation();
          scramble(d);
          if (decoyWindowActive() && decoys.length < MAX_DECOYS && Math.random() > 0.35){
            spawnDecoyNear(d, randomYesLabel());
          }
        }, {passive:true});
      });

      // üëá Snark on decoy tap
      d.addEventListener('click', (e)=>{
        e.preventDefault();
        const t = e.touches?.[0];
        const x = (t?.clientX??e.clientX)||0, y = (t?.clientY??e.clientY)||0;
        sparkleBurst(x, y);
        // Vibrate slightly on supported devices (harmless/no-op otherwise)
        if (navigator.vibrate) { navigator.vibrate(12); }
        // Pick a random snark just for decoy taps
        const snark = DECOY_SNARKS[Math.floor(Math.random()*DECOY_SNARKS.length)];
        tauntEl.textContent = snark;
        scramble(d);
      });
    }

    /* ---------- Golden YES Finale (ONLY confirm) ---------- */
    function spawnGoldenYes(withConfetti = false){
      if (goldenYesBtn) return;
      allowRealYes = true; // for messaging

      goldenYesBtn = document.createElement('button');
      goldenYesBtn.id = 'goldenYes';
      goldenYesBtn.className = 'btn yes golden-yes floating drop-bounce';
      goldenYesBtn.textContent = 'YES ‚ú®';
      goldenYesBtn.setAttribute('aria-label','The real, golden YES');
      buttons.appendChild(goldenYesBtn);

      const area = buttons.getBoundingClientRect();
      const centerX = area.left + area.width/2;
      const centerY = area.top + area.height/2;
      const targetLeft = (area.width/2 - 70);
      const targetTop  = (area.height/2 - 26);
      goldenYesBtn.style.left = targetLeft + 'px';
      goldenYesBtn.style.top  = targetTop  + 'px';

      yesBtn.disabled = true; // only golden can confirm

      if (withConfetti){
        confettiBurst(centerX, centerY, 90);
        sparkleBurst(centerX, centerY);
      } else {
        confettiBurst(centerX, centerY, 70);
      }

      goldenYesBtn.addEventListener('animationend', (e)=>{
        if (e.animationName === 'dropBounce'){
          goldenYesBtn.classList.remove('drop-bounce');
          goldenYesBtn.classList.add('floaty-on');
        }
      });

      goldenYesBtn.addEventListener('click', ()=>{
        celebrate();
        clearInterval(growthInterval);
        tauntEl.textContent = "You. Me. Always. üíó";
        noBtn.disabled = true;
      });
    }

    /* ---------- Hearts ---------- */
    function spawnHearts(count=60){
      const colors = ['#ff4d8d','#ff6fa3','#ff2e63','#ff9ac2','#ffb3cf'];
      const width = window.innerWidth;
      for (let i=0;i<count;i++){
        const h = document.createElement('div');
        h.className = 'heart';
        const size = 10 + Math.random()*16;
        const duration = 5 + Math.random()*3;
        const delay = Math.random()*0.6;
        const x = Math.random()*(width-20);
        h.style.left = `${x}px`; h.style.bottom = `-30px`;
        h.style.width = `${size}px`; h.style.height = `${size}px`;
        h.style.background = colors[i % colors.length];
        h.style.animationDuration = `${duration}s`;
        h.style.animationDelay = `${delay}s`;
        hearts.appendChild(h);
        setTimeout(()=> h.remove(), (duration+1.2)*1000);
      }
    }

    /* ---------- Success ---------- */
    function celebrate(){
      overlay.hidden = false;
      spawnHearts(110);
      confettiBurst(innerWidth/2, innerHeight*0.3, 80);
      stopJitter(); stopDecoyInterval(); stopCountdownChip();
      if (decoyEndTimeoutId) { clearTimeout(decoyEndTimeoutId); decoyEndTimeoutId = null; }
      if (goldenYesBtn) goldenYesBtn.classList.remove('floating');
    }
    replayBtn?.addEventListener('click', ()=> spawnHearts(80));

    /* ---------- Click Logic ---------- */
    yesBtn.addEventListener('click', (e)=>{
      // DESKTOP: spawn golden YES immediately (only confirmation path)
      if (!IS_MOBILE){
        if (!goldenYesBtn) {
          spawnGoldenYes(true);
          tauntEl.textContent = "Tap the golden YES to confirm. ‚ú®";
        }
        return;
      }

      // MOBILE: normal YES never confirms ‚Äî it only triggers chaos / decoys
      const elapsed = timeElapsedMs();
      if (!mischief) startMischief();

      const t = e.touches?.[0];
      sparkleBurst((t?.clientX??e.clientX)||0, (t?.clientY??e.clientY)||0);
      if (elapsed < YES_FAST_MS){
        showTaunt("Too quick, speedster. That was a tutorial YES. üòè");
      } else {
        showTaunt("Patience. The golden YES will appear when the stars align. ‚ú®");
      }
      scramble(yesBtn);
    });

    noBtn.addEventListener('click', ()=>{
      tauntEl.textContent = "Bold choice. Respectfully incorrect. Try again. üòå";
      noScale = Math.min(NO_MAX_SCALE, noScale * 1.08);
      noBtn.style.transform = `scale(${noScale}) rotate(${(noScale-1)*6}deg)`;
      if (IS_MOBILE && mischief) scramble(noBtn);
    });

    ['touchstart','pointerdown'].forEach(evt=>{
      yesBtn.addEventListener(evt, ()=>{ if (IS_MOBILE) startMischief(); }, {passive:true});
    });

    setTimeout(()=> sparkleBurst(innerWidth*0.6, innerHeight*0.3), 600);
  </script>
</body>
</html>
